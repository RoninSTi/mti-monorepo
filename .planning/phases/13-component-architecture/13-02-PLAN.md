---
phase: 13-component-architecture
plan: 02
type: execute
wave: 2
depends_on: ["13-01"]
files_modified:
  - frontend/src/main.tsx
  - frontend/src/App.tsx
  - frontend/src/components/layout/AppLayout.tsx
  - frontend/src/components/layout/Sidebar.tsx
  - frontend/src/pages/FactoriesPage.tsx
  - frontend/src/pages/GatewaysPage.tsx
  - frontend/src/pages/NotFoundPage.tsx
autonomous: true

must_haves:
  truths:
    - "Side navigation displays Factories and Gateways links"
    - "Active navigation link is visually highlighted with accent background"
    - "Clicking a navigation link changes the main content area while sidebar persists"
    - "Root URL (/) redirects to /factories"
    - "Unknown URLs show a Not Found page"
    - "Page layout has consistent sidebar + main content structure"
  artifacts:
    - path: "frontend/src/components/layout/AppLayout.tsx"
      provides: "Root layout with Sidebar and Outlet for child routes"
      contains: "Outlet"
    - path: "frontend/src/components/layout/Sidebar.tsx"
      provides: "Side navigation with NavLink active states"
      contains: "NavLink"
    - path: "frontend/src/pages/FactoriesPage.tsx"
      provides: "Factories placeholder page"
    - path: "frontend/src/pages/GatewaysPage.tsx"
      provides: "Gateways placeholder page"
    - path: "frontend/src/pages/NotFoundPage.tsx"
      provides: "404 page for unknown routes"
    - path: "frontend/src/main.tsx"
      provides: "Router configuration with createBrowserRouter"
      contains: "createBrowserRouter"
  key_links:
    - from: "frontend/src/main.tsx"
      to: "frontend/src/components/layout/AppLayout.tsx"
      via: "Router root element"
      pattern: "element.*AppLayout"
    - from: "frontend/src/components/layout/AppLayout.tsx"
      to: "react-router-dom"
      via: "Outlet renders child routes"
      pattern: "<Outlet"
    - from: "frontend/src/components/layout/Sidebar.tsx"
      to: "/factories and /gateways routes"
      via: "NavLink to= prop"
      pattern: "NavLink.*to=.*/factories"
---

<objective>
Configure React Router and build the application layout with sidebar navigation.

Purpose: Establish the navigation architecture (NAV-01, NAV-02, NAV-03) so users can navigate between Factories and Gateways pages with active link highlighting and a persistent sidebar layout.

Output: AppLayout and Sidebar components, three page placeholders, and router configuration wired into the app.
</objective>

<execution_context>
@/Users/craigcronin/.claude/get-shit-done/workflows/execute-plan.md
@/Users/craigcronin/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/13-component-architecture/13-RESEARCH.md
@frontend/src/main.tsx
@frontend/src/App.tsx
@frontend/src/lib/utils.ts
@frontend/src/index.css
@frontend/src/components/ui/button.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create layout components (AppLayout + Sidebar)</name>
  <files>
    frontend/src/components/layout/AppLayout.tsx
    frontend/src/components/layout/Sidebar.tsx
  </files>
  <action>
    Create the `frontend/src/components/layout/` directory and two components:

    **Sidebar.tsx:**
    - Import `NavLink` from `react-router-dom` and `cn` from `@/lib/utils`
    - Import `Factory` and `Radio` icons from `lucide-react` (Factory for factories, Radio for gateways -- gateways are wireless access points)
    - Create nav element with `<aside>` wrapper, width `w-64`, border-right, bg-background
    - Include app title/branding at the top: "MTI WiFi" in bold, with "Monitor" subtitle in muted text
    - Two NavLinks:
      - `/factories` with Factory icon and "Factories" text
      - `/gateways` with Radio icon and "Gateways" text
    - Use NavLink's `className` callback with `isActive` parameter:
      - Active: `bg-accent text-accent-foreground font-medium`
      - Inactive: `text-muted-foreground hover:bg-accent/50 hover:text-accent-foreground`
    - Each link: `flex items-center gap-3 rounded-lg px-3 py-2 text-sm transition-colors`
    - Export as named export `Sidebar`

    **AppLayout.tsx:**
    - Import `Outlet` from `react-router-dom`
    - Import `Sidebar` from `./Sidebar`
    - Flex container: `flex h-screen` (full viewport height)
    - Left: `<Sidebar />`
    - Right: `<main className="flex-1 overflow-auto">` with inner `<div className="p-6">` containing `<Outlet />`
    - Export as named export `AppLayout`

    Follow research pattern exactly. Use CSS theme variables (bg-background, text-foreground, bg-accent, etc.) -- no hardcoded colors.
  </action>
  <verify>
    Files exist at expected paths.
    `cd frontend && npx tsc --noEmit` — zero errors.
    AppLayout.tsx contains `<Outlet />`.
    Sidebar.tsx contains two `NavLink` components with `isActive` className callbacks.
  </verify>
  <done>
    AppLayout renders Sidebar + Outlet. Sidebar has two NavLinks (/factories, /gateways) with active state styling using theme CSS variables. Both components export named exports with TypeScript.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create placeholder pages and wire React Router</name>
  <files>
    frontend/src/pages/FactoriesPage.tsx
    frontend/src/pages/GatewaysPage.tsx
    frontend/src/pages/NotFoundPage.tsx
    frontend/src/main.tsx
    frontend/src/App.tsx
  </files>
  <action>
    **Create three placeholder page components in `frontend/src/pages/`:**

    **FactoriesPage.tsx:**
    - Simple page with `<h1>` "Factories" heading and `<p>` subtitle "Manage your factory locations"
    - Use `text-2xl font-bold` for heading, `text-muted-foreground` for subtitle
    - Named export `FactoriesPage`

    **GatewaysPage.tsx:**
    - Simple page with `<h1>` "Gateways" heading and `<p>` subtitle "Manage your wireless gateways"
    - Same styling pattern as FactoriesPage
    - Named export `GatewaysPage`

    **NotFoundPage.tsx:**
    - Center-aligned 404 message: "Page Not Found"
    - Include a link back to `/factories` using React Router's `Link` component
    - Named export `NotFoundPage`

    **Update main.tsx:**
    - Remove the `import App from './App.tsx'` line
    - Add imports: `createBrowserRouter`, `RouterProvider`, `Navigate` from `react-router-dom`
    - Import `AppLayout` from `@/components/layout/AppLayout`
    - Import `FactoriesPage`, `GatewaysPage`, `NotFoundPage` from `@/pages/*`
    - Create router with `createBrowserRouter`:
      ```
      {
        path: '/',
        element: <AppLayout />,
        children: [
          { index: true, element: <Navigate to="/factories" replace /> },
          { path: 'factories', element: <FactoriesPage /> },
          { path: 'gateways', element: <GatewaysPage /> },
          { path: '*', element: <NotFoundPage /> },
        ]
      }
      ```
    - Replace `<App />` with `<RouterProvider router={router} />`
    - Keep existing QueryClientProvider and ReactQueryDevtools wrapping (wrap RouterProvider inside them)

    **Delete or repurpose App.tsx:**
    - App.tsx is no longer needed since RouterProvider replaces it. Delete the file or leave it empty. The router is now the app entry point.

    IMPORTANT: Catch-all route (`path: '*'`) must be LAST in children array (per research pitfall #6).
    IMPORTANT: Keep `<QueryClientProvider>` and `<ReactQueryDevtools>` in main.tsx -- they wrap the entire app including the router.
  </action>
  <verify>
    `cd frontend && npx tsc --noEmit` — zero errors.
    `cd frontend && npm run build` — builds successfully.
    Verify main.tsx contains `createBrowserRouter` and `RouterProvider`.
    Verify main.tsx has `Navigate to="/factories" replace` for index route.
    Verify catch-all route is last child.
  </verify>
  <done>
    React Router configured with nested routes. Root (/) redirects to /factories. Three pages exist (Factories, Gateways, NotFound). Layout persists sidebar across navigation. Build succeeds. NAV-01 (side nav with links), NAV-02 (page layout), NAV-03 (routing) all satisfied.
  </done>
</task>

</tasks>

<verification>
1. `cd frontend && npm run build` succeeds with zero errors
2. `ls frontend/src/components/layout/` shows AppLayout.tsx and Sidebar.tsx
3. `ls frontend/src/pages/` shows FactoriesPage.tsx, GatewaysPage.tsx, NotFoundPage.tsx
4. main.tsx uses createBrowserRouter with nested routes under AppLayout
5. Sidebar.tsx uses NavLink with isActive for active state highlighting
6. AppLayout.tsx uses Outlet for rendering child routes
7. Index route redirects to /factories
8. Catch-all route (*) is last in children array
</verification>

<success_criteria>
- Side navigation displays Factories and Gateways links with icons
- Active link has distinct visual highlight (bg-accent)
- Router changes page content while sidebar persists (Outlet pattern)
- Root URL redirects to /factories
- Unknown URLs show Not Found page with link back
- Build succeeds with zero TypeScript errors
- NAV-01, NAV-02, NAV-03 requirements satisfied
- COMP-03 (components organized in layout/ directory) partially satisfied
</success_criteria>

<output>
After completion, create `.planning/phases/13-component-architecture/13-02-SUMMARY.md`
</output>
