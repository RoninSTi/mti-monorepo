---
phase: 06-testing-and-documentation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - .planning/phases/06-testing-and-documentation/TEST-CHECKLIST.md
autonomous: false

must_haves:
  truths:
    - "A structured test checklist exists covering all TEST-01 through TEST-07 requirements"
    - "Each test scenario has numbered steps, expected results, and recording sections"
    - "User has executed the full test suite against real gateway hardware"
    - "Actual results are recorded with timestamps, timing data, and pass/fail status"
  artifacts:
    - path: ".planning/phases/06-testing-and-documentation/TEST-CHECKLIST.md"
      provides: "Complete manual test checklist with recorded results"
      contains: "Pass/Fail"
  key_links:
    - from: "TEST-CHECKLIST.md"
      to: "npm run dev"
      via: "Manual execution of application against real hardware"
      pattern: "Actual Results"
---

<objective>
Create a comprehensive manual test checklist for gateway hardware validation, then execute all tests against real gateway hardware to validate the complete spike end-to-end.

Purpose: The entire spike exists to answer open questions about gateway behavior. This plan creates the structured test framework and guides the human through execution to capture real data that Plan 02 will document.

Output: TEST-CHECKLIST.md with all test scenarios filled in with actual hardware results.
</objective>

<execution_context>
@/Users/craigcronin/.claude/get-shit-done/workflows/execute-plan.md
@/Users/craigcronin/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/06-testing-and-documentation/06-RESEARCH.md
@src/main.ts
@src/config.ts
@src/acquisition/acquisition-manager.ts
@src/acquisition/waveform-parser.ts
@src/output/waveform-display.ts
@src/gateway/authenticator.ts
@src/gateway/sensor-discovery.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create structured test checklist covering TEST-01 through TEST-07</name>
  <files>.planning/phases/06-testing-and-documentation/TEST-CHECKLIST.md</files>
  <action>
Create `.planning/phases/06-testing-and-documentation/TEST-CHECKLIST.md` with the following structure:

**Header section:**
- Title: "Gateway Integration Spike - Manual Test Checklist"
- Fields for: Hardware (gateway model/serial), Tester, Date, Environment (network details, gateway IP), Application version/commit

**7 test scenarios, one per TEST requirement:**

**Scenario 1: Full End-to-End Flow (TEST-01)**
- Prerequisites: Gateway powered on, sensor connected, .env configured
- Steps: Run `npm run dev`, observe complete flow from connection through waveform display to clean exit
- Expected: Application runs to completion, displays waveform statistics, exits with code 0
- Actual Results: [blank section for recording]
- Pass/Fail: [blank]
- Notes: [blank - record total execution time, any warnings]

**Scenario 2: Connection Establishment (TEST-02)**
- Prerequisites: Gateway accessible on network
- Steps: Start app, observe connection logs, verify state transitions DISCONNECTED -> CONNECTING -> CONNECTED
- Expected: Connection within 10 seconds, no errors, WebSocket open state logged
- Actual Results: [blank]
- Notes: [blank - record actual connection time]

**Scenario 3: Authentication (TEST-03)**
- Prerequisites: Valid credentials in .env
- Steps: Observe POST_LOGIN command sent after connection, verify AUTHENTICATED state transition
- Expected: Auth succeeds, state transitions logged, no RTN_ERR
- Actual Results: [blank]
- Notes: [blank - record auth response time, any response data]

**Scenario 4: Sensor Discovery (TEST-04)**
- Prerequisites: At least one sensor powered on and connected to gateway
- Steps: Observe GET_DYN_CONNECTED command, review sensor list output
- Expected: At least one sensor returned with Serial, PartNum, ReadRate, Samples fields
- Actual Results: [blank - record sensor count, metadata for each sensor]
- Notes: [blank - record response time]

**Scenario 5: Reading Trigger (TEST-05)**
- Prerequisites: Successful auth and discovery
- Steps: Observe TAKE_DYN_READING command sent with selected sensor Serial
- Expected: Command accepted (no RTN_ERR), NOT_DYN_READING_STARTED notification received with Success=true
- Actual Results: [blank]
- Notes: [blank - record time between command and notification]

**Scenario 6: Waveform Data (TEST-06)**
- Prerequisites: Reading triggered successfully
- Steps: Observe NOT_DYN_READING notification, check parser output, review waveform statistics display
- Expected: X/Y/Z waveform strings received, parser identifies encoding format, statistics displayed (sample count, min/max/mean per axis, first 10 samples)
- Actual Results: [blank - THIS IS THE CRITICAL DISCOVERY SECTION]
- Sub-sections to fill in:
  - Encoding format detected (CSV/JSON/Base64)
  - Raw X string (first 200 chars)
  - Raw Y string (first 200 chars)
  - Raw Z string (first 200 chars)
  - Sample count per axis
  - Value ranges observed (min/max per axis)
  - Units (if determinable)
- Notes: [blank - record NOT_DYN_READING arrival time after STARTED notification]

**Scenario 7: Clean Shutdown (TEST-07)**
- Prerequisites: Full flow completed
- Steps: Observe POST_UNSUB_CHANGES sent, connection close logged, process exits
- Expected: Unsubscribe command sent, connection closes with code 1000, process exits 0
- Actual Results: [blank]
- Notes: [blank - record shutdown timing]

**Edge Case Scenarios (bonus - test if time permits):**
- Wrong password: Change GATEWAY_PASSWORD to invalid value, observe error handling
- No sensors: Disconnect all sensors from gateway, observe graceful exit
- Network interruption: Run reading, then briefly disconnect network, observe recovery/error
- SIGINT during acquisition: Start reading, press Ctrl+C, observe shutdown behavior

**Summary section at bottom:**
- Overall result: PASS/FAIL
- Total execution time
- Key discoveries (waveform encoding, timing characteristics, unexpected behavior)
- Issues encountered
- Recommendations for Milestone 1

Use the research patterns from 06-RESEARCH.md (Pattern 1: Test Checklist Structure). Keep formatting clean and easy to fill in during live testing.
  </action>
  <verify>
File exists at `.planning/phases/06-testing-and-documentation/TEST-CHECKLIST.md`. File contains all 7 numbered test scenarios. Each scenario has Steps, Expected Results, Actual Results, Pass/Fail, and Notes sections. Scenario 6 (Waveform Data) has detailed sub-sections for encoding discovery.
  </verify>
  <done>TEST-CHECKLIST.md exists with 7 complete test scenarios matching TEST-01 through TEST-07, each with structured recording sections ready for manual execution.</done>
</task>

<task type="checkpoint:human-action" gate="blocking">
  <name>Task 2: Execute manual test suite against real gateway hardware</name>
  <action>
Execute the full test checklist against real CTC Connect Wireless gateway hardware.
  </action>
  <instructions>
You need to run the test checklist against real gateway hardware. This is the core validation that the entire spike was built for.

**Before starting:**
1. Ensure gateway is powered on and accessible on network
2. Ensure at least one vibration sensor is connected to gateway
3. Ensure `.env` file exists with valid GATEWAY_URL, GATEWAY_EMAIL, GATEWAY_PASSWORD
4. Set LOG_LEVEL=debug in .env for maximum visibility during testing

**Execute tests:**
1. Run `npm run dev` from the project root
2. As the application runs through its flow, record results in `TEST-CHECKLIST.md` for each scenario
3. Pay special attention to Scenario 6 (Waveform Data) - capture the encoding format, raw data samples, and value ranges
4. After successful run, optionally test edge cases (wrong password, no sensors, Ctrl+C)

**Critical data to capture:**
- Exact timing between commands and responses (from log timestamps)
- The waveform encoding format that the parser detected
- Raw X/Y/Z string samples (first 200 chars of each)
- Any RTN_ERR messages or unexpected close codes
- NOT_DYN_TEMP notification data (if received)
- Complete sensor metadata for discovered sensors

**After testing:**
Fill in the Summary section at the bottom of TEST-CHECKLIST.md with overall results and key discoveries.

When complete, type "tests complete" to continue to Plan 02 (documentation).
  </instructions>
  <resume-signal>Type "tests complete" after filling in TEST-CHECKLIST.md with actual results</resume-signal>
</task>

</tasks>

<verification>
- TEST-CHECKLIST.md exists with all 7 scenarios
- Each scenario has a completed Actual Results section (not blank)
- Scenario 6 has waveform encoding details captured
- Summary section is filled in
</verification>

<success_criteria>
- All 7 test scenarios have been executed against real hardware
- Actual results are recorded with timestamps and observed data
- Waveform encoding format has been discovered and documented in the checklist
- Key timing characteristics are captured (command response times, notification delays)
- Edge cases tested where possible
</success_criteria>

<output>
After completion, create `.planning/phases/06-testing-and-documentation/06-01-SUMMARY.md`
</output>
